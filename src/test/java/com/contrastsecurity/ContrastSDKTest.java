package com.contrastsecurity;

import com.contrastsecurity.exceptions.ResourceNotFoundException;
import com.contrastsecurity.exceptions.UnauthorizedException;
import com.contrastsecurity.models.Applications;
import com.contrastsecurity.models.Rules;
import com.contrastsecurity.models.Traces;
import com.contrastsecurity.sdk.ContrastSDK;
import com.google.gson.Gson;
import org.junit.BeforeClass;
import org.junit.Test;

import java.io.IOException;

import static org.junit.Assert.*;

public class ContrastSDKTest extends ContrastSDK {

    private static ContrastSDK contrastSDK;
    private static Gson gson;

    @BeforeClass
    public static void setUp() {
        contrastSDK = new ContrastSDK("contrast_admin", "demo", "demo", "http://localhost:19080/Contrast/api");
        gson = new Gson();
    }

    @Test
    public void testGetApplication() throws UnauthorizedException, IOException, ResourceNotFoundException {

        String applicationString = "{\"application\":{\"app_id\":\"3da856f4-c508-48b8-95a9-514eddefcbf3\",\"archived\":false,\"created\":1461599820000,\"status\":\"offline\",\"path\":\"/WebGoat\",\"name\":\"WebGoat\",\"language\":\"Java\",\"last_seen\":1461737160000,\"total_modules\":1,\"master\":false}}";

        Applications app = gson.fromJson(applicationString, Applications.class);

        assertNotNull(app);
        assertNotNull(app.getApplication());

        assertNull(app.getApplications());
    }

    @Test
    public void testGetApplications() throws UnauthorizedException, IOException, ResourceNotFoundException {

        String applicationsString = "{\"applications\":[{\"app_id\":\"72358543-bbdb-490c-8e3f-1b5f5e9a0bf7\",\"archived\":false,\"created\":1461631080000,\"status\":\"offline\",\"path\":\"/Curl\",\"name\":\"Contrast-Curl\",\"language\":\"Java\",\"last_seen\":1461631080000,\"total_modules\":1,\"master\":false},{\"app_id\":\"b9acb026-36a6-4f4e-b568-33168b7a5ae6\",\"archived\":false,\"created\":1460582653000,\"status\":\"offline\",\"path\":\"/portal\",\"name\":\"portal\",\"language\":\"Java\",\"last_seen\":1460925180000,\"total_modules\":1,\"master\":false},{\"app_id\":\"53775e84-90a6-4a64-bafe-2b153c3a40f0\",\"archived\":false,\"created\":1460582640000,\"status\":\"offline\",\"path\":\"/\",\"name\":\"ROOT\",\"language\":\"Java\",\"last_seen\":1460925180000,\"total_modules\":1,\"master\":false},{\"app_id\":\"9e88815f-bb0d-44b4-ac5a-f02f661e8947\",\"archived\":false,\"created\":1460582659000,\"status\":\"offline\",\"path\":\"/library\",\"name\":\"sakai-library\",\"language\":\"Java\",\"last_seen\":1460925180000,\"total_modules\":1,\"master\":false},{\"app_id\":\"e9a14797-42e7-4ba4-8282-364fdf37026c\",\"archived\":false,\"created\":1460582916000,\"status\":\"offline\",\"path\":\"/sakai-user-tool\",\"name\":\"sakai-user-tool\",\"language\":\"Java\",\"last_seen\":1460925180000,\"total_modules\":2,\"master\":true},{\"app_id\":\"469b9147-5736-4b83-9158-657427d4c960\",\"archived\":false,\"created\":1461600682000,\"status\":\"offline\",\"path\":\"/examples\",\"name\":\"Servlet and JSP Examples\",\"language\":\"Java\",\"last_seen\":1461737160000,\"total_modules\":1,\"master\":false},{\"app_id\":\"3da856f4-c508-48b8-95a9-514eddefcbf3\",\"archived\":false,\"created\":1461599820000,\"status\":\"offline\",\"path\":\"/WebGoat\",\"name\":\"WebGoat\",\"language\":\"Java\",\"last_seen\":1461737160000,\"total_modules\":1,\"master\":false}]}";

        Applications apps = gson.fromJson(applicationsString, Applications.class);

        assertNotNull(apps);
        assertNotNull(apps.getApplications());

        assertNull(apps.getApplication());
        assertTrue(!apps.getApplications().isEmpty());
    }

    @Test
    public void testGetTraces() throws UnauthorizedException, IOException, ResourceNotFoundException {

        String tracesString = "{\"count\":2,\"traces\":[{\"title\":\"Application Disables \\u0027secure\\u0027 Flag on Cookies observed at DefaultSavedRequest.java\",\"language\":\"Java\",\"status\":\"Reported\",\"uuid\":\"KNBG-XTO9-ED1O-PG2X\",\"rule_name\":\"cookie-flags-missing\",\"severity\":\"Medium\",\"likelihood\":\"High\",\"impact\":\"Low\",\"confidence\":\"High\",\"first_time_seen\":1461600923859,\"last_time_seen\":1461601039100,\"category\":\"Secure Communications\",\"platform\":\"Oracle Corporation\",\"total_traces_received\":5,\"visible\":true},{\"title\":\"Insecure Authentication Protocol\",\"evidence\":\"Authorization: Basic Z3Vl...Q6Z3Vlc3Q\\u003d\",\"language\":\"Java\",\"status\":\"Reported\",\"uuid\":\"IJ92-WGDU-JCY4-F4EZ\",\"rule_name\":\"insecure-auth-protocol\",\"severity\":\"Medium\",\"likelihood\":\"Medium\",\"impact\":\"Medium\",\"confidence\":\"High\",\"first_time_seen\":1461600923853,\"last_time_seen\":1461601039100,\"category\":\"Access Control\",\"platform\":\"Oracle Corporation\",\"total_traces_received\":5,\"visible\":true}]}";

        Traces traces = gson.fromJson(tracesString, Traces.class);

        assertNotNull(traces);
        assertNotNull(traces.getTraces());

        assertTrue(traces.getCount() > 0);
    }


    @Test
    public void getGetRules() throws UnauthorizedException, IOException, ResourceNotFoundException {
        
        String rulesString = "{\"rules\":[{\"description\":\"Verifies that caching controls are used to protect application content.\",\"title\":\"Anti-Caching Controls Missing\",\"category\":\"Caching\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/525.html\",\"owasp\":\"https://www.owasp.org/index.php/Testing_for_Logout_and_Browser_Cache_Management_(OWASP-AT-007)\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"cache-controls-missing\"},{\"description\":\"Verifies that cookies have the \\u0027secure\\u0027 flag.\",\"title\":\"Application Disables \\u0027secure\\u0027 Flag on Cookies\",\"category\":\"Secure Communications\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/614.html\",\"owasp\":\"http://www.owasp.org/index.php/SecureFlag\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"cookie-flags-missing\"},{\"description\":\"Verifies that no untrusted data is used to build a path used in forwards.\",\"title\":\"Arbitrary Server Side Forwards\",\"category\":\"Access Control\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/22.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards\",\"https://blog.gdssecurity.com/labs/2011/9/9/net-servertransfer-vs-responseredirect-reiterating-a-securit.html\"],\"free\":false,\"name\":\"unvalidated-forward\"},{\"description\":\"Verifies that the application\\u0027s authorization rules do not include an allow all user rule before a deny rule.\",\"title\":\"Authorization Rules Misordered\",\"category\":\"Access Control\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/284.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"Medium\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.authorizationsection.aspx\"],\"free\":false,\"name\":\"authorization-rules-misordered\"},{\"description\":\"Verifies that the application\\u0027s authorization rules include a deny rule.\",\"title\":\"Authorization Rules Missing Deny Rule\",\"category\":\"Access Control\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/294.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"Medium\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.authorizationsection.aspx\"],\"free\":false,\"name\":\"authorization-missing-deny\"},{\"description\":\"Verifies that automatic escaping is not disabled\",\"title\":\"Automatic Escaping Disabled\",\"category\":\"XSS\",\"impact\":\"Medium\",\"likelihood\":\"High\",\"enabled\":\"false\",\"cwe\":\"http://cwe.mitre.org/data/definitions/79.html\",\"owasp\":\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://www.playframework.com/documentation/1.1.1/security#xss\"],\"free\":false,\"name\":\"escape-templates-off\"},{\"description\":\"Verifies that the application does not disable the cache control header which helps prevent disclosure of sensitive information via the browser cache.\",\"title\":\"Cache Control Header Disabled\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/525.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.sendcachecontrolheader.aspx\"],\"free\":false,\"name\":\"cache-control-disabled\"},{\"description\":\"Verifies that tokens are used to prevent forgeable HTTP traffic\",\"title\":\"Cross-Site Request Forgery\",\"category\":\"Authentication\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/352.html\",\"owasp\":\"https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)\",\"confidence\":\"Low\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet\",\"https://en.wikipedia.org/wiki/Cross-site_request_forgery\",\"https://threatpost.com/exploit-kit-using-csrf-to-redirect-soho-router-dns-settings/112993/\"],\"free\":false,\"name\":\"csrf\"},{\"description\":\"Verifies that no untrusted data is used in generated HTML pages\",\"title\":\"Cross-Site Scripting\",\"category\":\"XSS\",\"impact\":\"Medium\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/79.html\",\"owasp\":\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)\"],\"free\":false,\"name\":\"reflected-xss\"},{\"description\":\"Verifies that the application does not inadvertently reveal sensitive or technical information to an attacker via detailed error messages.\",\"title\":\"Detailed Error Messages Displayed\",\"category\":\"Error Handling\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/756.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/y123fsf7.aspx\"],\"free\":false,\"name\":\"custom-errors-off\"},{\"description\":\"Verifies that the application does not disable ASP.NET event validation.\",\"title\":\"Event Validation Disabled\",\"category\":\"Input Validation\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/20.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/y123fsf7.aspx\",\"http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableeventvalidation.aspx\"],\"free\":false,\"name\":\"event-validation-disabled\"},{\"description\":\"Verifies that the application generates new session IDs rather than allowing attackers to use expired session IDs\",\"title\":\"Expired Session IDs Not Regenerated\",\"category\":\"Session Management\",\"impact\":\"Low\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/384.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\",\"confidence\":\"High\",\"severity\":\"Low\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.sessionstatesection.regenerateexpiredsessionid.aspx\"],\"free\":false,\"name\":\"session-regenerate\"},{\"description\":\"Verifies that untrusted data is not used in the evaluation of JSP Expression Language.\",\"title\":\"Expression Language Injection\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/88.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Expression_Language_Injection\"],\"free\":false,\"name\":\"expression-language-injection\"},{\"description\":\"Verifies that the application is using both encryption and validation for forms authentication.\",\"title\":\"Forms Auth Protection Mode\",\"category\":\"Authentication\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/592.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.formsauthenticationconfiguration.protection.aspx\"],\"free\":false,\"name\":\"forms-auth-protection\"},{\"description\":\"Verifies that the application does not allow for cross-app redirects for authentication which can expose the forms authentication ticket in the URL.\",\"title\":\"Forms Authentication Cross-App Redirect\",\"category\":\"Authentication\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/592.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.formsauthenticationconfiguration.enablecrossappredirects.aspx\"],\"free\":false,\"name\":\"forms-auth-redirect\"},{\"description\":\"Verifies that forms authentication requests must be submitted over SSL.\",\"title\":\"Forms Authentication SSL\",\"category\":\"Authentication\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/319.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.formsauthenticationconfiguration.requiressl.aspx\"],\"free\":false,\"name\":\"forms-auth-ssl\"},{\"description\":\"Verifies that browsers are notified that the application doesn\\u0027t want to use autocomplete for the given fields.\",\"title\":\"Forms Without Autocomplete Prevention\",\"category\":\"Caching\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/522.html\",\"owasp\":\"https://www.owasp.org/index.php/Testing_for_Vulnerable_Remember_Password_and_Pwd_Reset_(OWASP-AT-006)\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"autocomplete-missing\"},{\"description\":\"Verifies that hardcoded cryptographic keys don\\u0027t appear in source code.\",\"title\":\"Hardcoded Cryptographic Key\",\"category\":\"Cryptography\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/321.html\",\"owasp\":\"https://www.owasp.org/index.php/Use_of_hard-coded_cryptographic_key\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.securecoding.cert.org/confluence/display/java/MSC03-J.+Never+hard+code+sensitive+information\"],\"free\":false,\"name\":\"hardcoded-key\"},{\"description\":\"Verifies that hardcoded passwords don\\u0027t appear in source code.\",\"title\":\"Hardcoded Password\",\"category\":\"Cryptography\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/259.html\",\"owasp\":\"https://www.owasp.org/index.php/Use_of_hard-coded_password\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.securecoding.cert.org/confluence/display/java/MSC03-J.+Never+hard+code+sensitive+information\"],\"free\":false,\"name\":\"hardcoded-password\"},{\"description\":\"Verifies that the application does not disable ASP.NET\\u0027s defense against header injection.\",\"title\":\"Header Checking Disabled\",\"category\":\"Configuration\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/756.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.enableheaderchecking.aspx\"],\"free\":false,\"name\":\"header-checking-disabled\"},{\"description\":\"Verifies that untrusted data is not used in an HTTP header\",\"title\":\"Header Injection\",\"category\":\"Injection\",\"impact\":\"Medium\",\"likelihood\":\"High\",\"enabled\":\"false\",\"cwe\":\"http://cwe.mitre.org/data/definitions/113.html\",\"owasp\":\"https://www.owasp.org/index.php/CRLF_Injection\",\"confidence\":\"Low\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"header-injection\"},{\"description\":\"Verifies that no untrusted data is appended to dynamically constructed hibernate queries.\",\"title\":\"Hibernate Injection\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/564.html\",\"owasp\":\"https://www.owasp.org/index.php/Hibernate-Guidelines\",\"confidence\":\"High\",\"severity\":\"Critical\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\",\"https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet\"],\"free\":false,\"name\":\"hql-injection\"},{\"description\":\"Verifies that the HttpOnly flag is not disabled for cookies issued by the application.\",\"title\":\"HttpOnly Cookie Flag Disabled\",\"category\":\"Session Management\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/87.html\",\"owasp\":\"https://www.owasp.org/index.php/HttpOnly\",\"confidence\":\"High\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"http-only-disabled\"},{\"description\":\"Verifies applications don\\u0027t use weak HTTP authentication protocols.\",\"title\":\"Insecure Authentication Protocol\",\"category\":\"Access Control\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/287.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Insecure_Configuration_Management\"],\"free\":false,\"name\":\"insecure-auth-protocol\"},{\"description\":\"Verifies that only strong cryptographic algorithms are used.\",\"title\":\"Insecure Encryption Algorithms\",\"category\":\"Cryptography\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/327.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2010-A7-Insecure_Cryptographic_Storage\",\"https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet\"],\"free\":false,\"name\":\"crypto-bad-ciphers\"},{\"description\":\"Verifies that only strong hash algorithms are used\",\"title\":\"Insecure Hash Algorithms\",\"category\":\"Cryptography\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/328.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet\"],\"free\":false,\"name\":\"crypto-bad-mac\"},{\"description\":\"Verifies that JSPs are protected from direct access.\",\"title\":\"Insecure JSP Placement\",\"category\":\"Access Control\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/219.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Insecure_Configuration_Management\"],\"free\":false,\"name\":\"insecure-jsp-access\"},{\"description\":\"Verifies that untrusted data is not used in a reflection API.\",\"title\":\"Java Reflection Injection\",\"category\":\"Injection\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/470.html\",\"owasp\":\"https://www.owasp.org/index.php/Reflection_injection\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"reflection-injection\"},{\"description\":\"Verifies that the application does not allow large requests which could lead to denial of service attacks.\",\"title\":\"Large Max Request Length\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/400.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.maxrequestlength.aspx\"],\"free\":false,\"name\":\"max-request-length\"},{\"description\":\"Verifies that no untrusted data is used in dynamic LDAP queries.\",\"title\":\"LDAP Injection\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/90.html\",\"owasp\":\"https://www.owasp.org/index.php/LDAP_injection\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"ldap-injection\"},{\"description\":\"Verifies that no untrusted data is put into log files.\",\"title\":\"Log Injection\",\"category\":\"Injection\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/93.html\",\"owasp\":\"https://www.owasp.org/index.php/Log_Forging\",\"confidence\":\"High\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"log-injection\"},{\"description\":\"Verifies that no untrusted data is used in dynamic database queries.\",\"title\":\"NoSQL Injection\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/943.html\",\"owasp\":\"https://www.owasp.org/index.php/Testing_for_NoSQL_injection\",\"confidence\":\"High\",\"severity\":\"Critical\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"nosql-injection\"},{\"description\":\"Verifies that no untrusted data is used in commands sent to the operating system.\",\"title\":\"OS Command Injection\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/78.html\",\"owasp\":\"https://www.owasp.org/index.php/Command_Injection\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"cmd-injection\"},{\"description\":\"Verifies that HTTP sessions are terminated after reasonable idle periods.\",\"title\":\"Overly Long Session Timeout\",\"category\":\"Session Management\",\"impact\":\"Medium\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/613.html\",\"owasp\":\"https://www.owasp.org/index.php/Session_Management_Cheat_Sheet\",\"confidence\":\"Low\",\"severity\":\"Low\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"session-timeout\"},{\"description\":\"Verifies that frame-breaking controls are used on every page.\",\"title\":\"Pages Without Anti-Clickjacking Controls\",\"category\":\"Authentication\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/693.html\",\"owasp\":\"https://www.owasp.org/index.php/Clickjacking\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://en.wikipedia.org/wiki/Clickjacking\",\"http://www.sectheory.com/clickjacking.htm\",\"http://tools.ietf.org/html/draft-ietf-websec-x-frame-options-01\"],\"free\":false,\"name\":\"clickjacking-control-missing\"},{\"description\":\"Verifies that HTML form tags don\\u0027t allow attackers to fixate parameter variables and bypass CSRF controls.\",\"title\":\"Parameter Pollution\",\"category\":\"Caching\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/235.html\",\"owasp\":\"https://www.owasp.org/index.php/Testing_for_HTTP_Parameter_pollution_(OWASP-DV-004)\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://java.net/attachments/lists/servlet-spec/users/2012-06/20/OnParameterPollutionAttacks.pdf\",\"https://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf\"],\"free\":false,\"name\":\"parameter-pollution\"},{\"description\":\"Verifies that file paths containing untrusted data are not accessed.\",\"title\":\"Path Traversal\",\"category\":\"Input Validation\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/22.html\",\"owasp\":\"https://www.owasp.org/index.php/Path_Traversal\",\"confidence\":\"Medium\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"path-traversal\"},{\"description\":\"Verifies that the application does not disable ASP.NET\\u0027s Request Validation feature which helps prevent several attacks such as cross-site scripting.\",\"title\":\"Request Validation Disabled\",\"category\":\"Input Validation\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/20.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/hh882339.aspx\"],\"free\":false,\"name\":\"request-validation-disabled\"},{\"description\":\"Verifies that the application does not disable ASP.NET\\u0027s Request Validation feature for web controls which helps prevent several attacks such as cross-site scripting.\",\"title\":\"Request Validation Mode Disabled\",\"category\":\"Input Validation\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/20.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/hh882339.aspx\"],\"free\":false,\"name\":\"request-validation-control-disabled\"},{\"description\":\"Verifies that the requests sent by the application have the Content-Security-Policy header set in a restrictive way.\",\"title\":\"Response With Insecurely Configured Content-Security-Policy Header\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"false\",\"cwe\":\"https://cwe.mitre.org/data/definitions/602.html\",\"owasp\":\"https://www.owasp.org/index.php/Content_Security_Policy\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"csp-header-insecure\"},{\"description\":\"Verifies that the requests sent by the application have the Strict Transport Security header set correctly.\",\"title\":\"Response With Insecurely Configured Strict-Transport-Security Header\",\"category\":\"Secure Communications\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"false\",\"cwe\":\"https://cwe.mitre.org/data/definitions/319.html\",\"owasp\":\"https://www.owasp.org/index.php/HTTP_Strict_Transport_Security\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"hsts-header-missing\"},{\"description\":\"Verifies that the requests sent by the application have the X-XSS-Protection header left default (secure) or set correctly.\",\"title\":\"Response With X-XSS-Protection Disabled\",\"category\":\"XSS\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"false\",\"cwe\":\"https://cwe.mitre.org/data/definitions/79.html\",\"owasp\":\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)\"],\"free\":false,\"name\":\"xxssprotection-header-disabled\"},{\"description\":\"Verifies that the requests sent by the application have the Content-Security-Policy or Content-Security-Policy-Read-Only header set.\",\"title\":\"Response Without Content-Security-Policy Header\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"false\",\"cwe\":\"https://cwe.mitre.org/data/definitions/602.html\",\"owasp\":\"https://www.owasp.org/index.php/Content_Security_Policy\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"csp-header-missing\"},{\"description\":\"Verifies that the requests sent by the application have the X-Content-Type header set correctly.\",\"title\":\"Response Without X-Content-Type Header\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"false\",\"cwe\":\"https://cwe.mitre.org/data/definitions/693.html\",\"owasp\":\"https://www.owasp.org/index.php/List_of_useful_HTTP_headers\",\"confidence\":\"Low\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"xcontenttype-header-missing\"},{\"description\":\"Verifies that the application is using both encryption and validation to protect role cookie.\",\"title\":\"Role Manager Protection Mode\",\"category\":\"Access Control\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/264.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.security.roles.cookieprotectionvalue.aspx\"],\"free\":false,\"name\":\"role-manager-protection\"},{\"description\":\"Verifies that role manager cookies will only be submitted over SSL.\",\"title\":\"Role Manager SSL\",\"category\":\"Access Control\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/319.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.security.roles.cookierequiresssl.aspx\"],\"free\":false,\"name\":\"role-manager-ssl\"},{\"description\":\"Verifies that session cookies have the HttpOnly flag.\",\"title\":\"Session Cookie Has No \\u0027HttpOnly\\u0027 Flag\",\"category\":\"Session Management\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/87.html\",\"owasp\":\"https://www.owasp.org/index.php/HttpOnly\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"httponly\"},{\"description\":\"Verifies that session cookies have the secure flag.\",\"title\":\"Session Cookie Has No \\u0027secure\\u0027 Flag\",\"category\":\"Session Management\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/614.html\",\"owasp\":\"https://www.owasp.org/index.php/SecureFlag\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\"],\"free\":false,\"name\":\"secure-flag-missing\"},{\"description\":\"Verifies that session IDs aren\\u0027t being rewritten in the URL.\",\"title\":\"Session Rewriting\",\"category\":\"Session Management\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/384.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"session-rewriting\"},{\"description\":\"Verifies that no untrusted data is used in dynamic database queries.\",\"title\":\"SQL Injection\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/89.html\",\"owasp\":\"https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet\",\"confidence\":\"High\",\"severity\":\"Critical\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"sql-injection\"},{\"description\":\"Verifies that no untrusted data which was stored in a database is displayed in generated HTML pages\",\"title\":\"Stored Cross-Site Scripting\",\"category\":\"XSS\",\"impact\":\"Medium\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/79.html\",\"owasp\":\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)\"],\"free\":false,\"name\":\"stored-xss\"},{\"description\":\"Verifies that the application does not inadvertently reveal technical details and sensitive request information via the ASP.NET Tracing feature.\",\"title\":\"Tracing Enabled\",\"category\":\"Configuration\",\"impact\":\"High\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/497.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Critical\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/bb386420.aspx\"],\"free\":false,\"name\":\"trace-enabled\"},{\"description\":\"Verifies that the application does not inadvertently reveal technical details via the ASP.NET Tracing feature for a single ASPX page.\",\"title\":\"Tracing Enabled for ASPX\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/497.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/bb386420.aspx\"],\"free\":false,\"name\":\"trace-enabled-aspx\"},{\"description\":\"Verifies that untrusted data is not used in the HTTP session.\",\"title\":\"Trust Boundary Violation\",\"category\":\"Injection\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/501.html\",\"owasp\":\"https://www.owasp.org/index.php/Trust_Boundary_Violation\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Trust_Boundary_Violation\"],\"free\":false,\"name\":\"trust-boundary-violation\"},{\"description\":\"Verifies that Spring @InitBinder methods are limited in what fields can be automatically bound.\",\"title\":\"Unchecked Spring Autobinding\",\"category\":\"Input Validation\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/915.html\",\"owasp\":\"https://www.owasp.org/index.php/OWASP_Secure_Application_Design_Project#Data_Binding_Technique\",\"confidence\":\"Low\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"spring-unchecked-autobinding\"},{\"description\":\"Verifies that connection strings stored in web.config are encrypted.\",\"title\":\"Unprotected Connection Strings\",\"category\":\"Configuration\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/13.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/53tyfkaw.aspx\",\"http://msdn.microsoft.com/en-us/library/ms254494.aspx\",\"http://msdn.microsoft.com/en-us/library/ff647398.aspx\"],\"free\":false,\"name\":\"plaintext-conn-strings\"},{\"description\":\"Verifies that no untrusted data is used in a dynamic evaluation call.\",\"title\":\"Unsafe Code Execution\",\"category\":\"Injection\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/95.html\",\"owasp\":\"https://www.owasp.org/index.php/Code_Injection\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"unsafe-code-execution\"},{\"description\":\"Verifies that use of the JavaBeans XMLDecoder is not done with untrusted data.\",\"title\":\"Unsafe XML Decoding\",\"category\":\"Input Validation\",\"impact\":\"High\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/96.html\",\"owasp\":\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://blog.diniscruz.com/2013/08/using-xmldecoder-to-execute-server-side.html\",\"http://docs.oracle.com/javase/7/docs/api/java/beans/XMLDecoder.html\"],\"free\":false,\"name\":\"unsafe-xml-decode\"},{\"description\":\"Verifies that objects aren\\u0027t deserialized from untrusted sources.\",\"title\":\"Untrusted Deserialization\",\"category\":\"Input Validation\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/502.html\",\"owasp\":\"https://www.owasp.org/index.php/Deserialization_of_untrusted_data\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/\"],\"free\":false,\"name\":\"untrusted-deserialization\"},{\"description\":\"Verifies that requests are not redirected using untrusted data.\",\"title\":\"Unvalidated Redirect\",\"category\":\"Input Validation\",\"impact\":\"Medium\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/601.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"unvalidated-redirect\"},{\"description\":\"Verifies that untrusted stream doesn\\u0027t use readLine() method.\",\"title\":\"Use of readLine on Untrusted Streams\",\"category\":\"Availability\",\"impact\":\"Medium\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/434.html\",\"owasp\":\"https://www.owasp.org/index.php/Application_Denial_of_Service\",\"confidence\":\"High\",\"severity\":\"Low\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"unsafe-readline\"},{\"description\":\"Verifies that the security constraints in web.xml are configured correctly.\",\"title\":\"Verb Tampering Weakness\",\"category\":\"Access Control\",\"impact\":\"Medium\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/302.html\",\"owasp\":\"https://www.owasp.org/index.php/Testing_for_HTTP_Verb_Tampering_(OWASP-DV-003)\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.aspectsecurity.com/research/aspsec_presentations/download-bypassing-web-authentication-and-authorization-with-http-verb-tampering/\"],\"free\":false,\"name\":\"verb-tampering\"},{\"description\":\"Verifies that the application does not send the ASP.NET version header.\",\"title\":\"Version Header Enabled\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/200.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.enableversionheader.aspx\"],\"free\":false,\"name\":\"version-header-enabled\"},{\"description\":\"\",\"title\":\"Viewstate Encryption Disabled\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/311.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.viewstateencryptionmode.aspx\"],\"free\":false,\"name\":\"viewstate-encryption-disabled\"},{\"description\":\"Verifies that the application prevents attackers from modifying viewstate values.\",\"title\":\"Viewstate MAC Validation Disabled\",\"category\":\"Input Validation\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/20.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/950xf363(v\\u003dvs.100).aspx\",\"http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableviewstatemac.aspx\"],\"free\":false,\"name\":\"viewstate-mac-disabled\"},{\"description\":\"Verifies that the application does not expose exception details for hosted WCF services.\",\"title\":\"WCF Exception Details\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/215.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Medium\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.includeexceptiondetailinfaults(v\\u003dvs.110).aspx\"],\"free\":false,\"name\":\"wcf-exception-details\"},{\"description\":\"Verifies that the application uses replay detection for custom bindings.\",\"title\":\"WCF Replay Detection Not Enabled\",\"category\":\"Configuration\",\"impact\":\"Medium\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/200.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Low\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/aa738652(v\\u003dvs.110).aspx\"],\"free\":false,\"name\":\"wcf-detect-replays\"},{\"description\":\"Verifies that the application does not publish metadata for hosted WCF services.\",\"title\":\"WCF Service Metadata Enabled\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/651.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/System.ServiceModel.Description.ServiceMetadataBehavior_properties(v\\u003dvs.110).aspx\"],\"free\":false,\"name\":\"wcf-metadata-enabled\"},{\"description\":\"Verifies that membership authentication is configured to help withstand password bruteforce attacks.\",\"title\":\"Weak Membership Configuration\",\"category\":\"Authentication\",\"impact\":\"Low\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/307.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management\",\"confidence\":\"Medium\",\"severity\":\"Low\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/System.Web.Security.Membership.aspx\"],\"free\":false,\"name\":\"weak-membership-config\"},{\"description\":\"Verifies that weak sources of entropy are not used.\",\"title\":\"Weak Random Number Generation\",\"category\":\"Cryptography\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"false\",\"cwe\":\"http://cwe.mitre.org/data/definitions/330.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure\",\"confidence\":\"Medium\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"crypto-weak-randomness\"},{\"description\":\"Verifies that the application is not deployed in debug mode.\",\"title\":\"Web Application Deployed in Debug Mode\",\"category\":\"Configuration\",\"impact\":\"Low\",\"likelihood\":\"Low\",\"enabled\":\"true\",\"cwe\":\"https://cwe.mitre.org/data/definitions/11.html\",\"owasp\":\"https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration\",\"confidence\":\"High\",\"severity\":\"Note\",\"serviceLevel\":\"Enterprise\",\"references\":[\"http://msdn.microsoft.com/en-us/library/s10awwz0(v\\u003dvs.100).aspx\",\"http://msdn.microsoft.com/en-us/library/ff400235(v\\u003dvs.100).aspx\"],\"free\":false,\"name\":\"compilation-debug\"},{\"description\":\"Verifies that external entities aren\\u0027t processed during XML.\",\"title\":\"XML External Entity Injection (XXE)\",\"category\":\"Input Validation\",\"impact\":\"High\",\"likelihood\":\"Medium\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/611.html\",\"owasp\":\"https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[],\"free\":false,\"name\":\"xxe\"},{\"description\":\"Verifies that no untrusted data is used in XPath expression used to retrieve data from an XML database\",\"title\":\"XPath Injection\",\"category\":\"Injection\",\"impact\":\"Medium\",\"likelihood\":\"High\",\"enabled\":\"true\",\"cwe\":\"http://cwe.mitre.org/data/definitions/643.html\",\"owasp\":\"https://www.owasp.org/index.php/XPATH_Injection\",\"confidence\":\"High\",\"severity\":\"High\",\"serviceLevel\":\"Enterprise\",\"references\":[\"https://www.owasp.org/index.php/Top_10_2013-A1-Injection\"],\"free\":false,\"name\":\"xpath-injection\"}]}";

        Rules rules = gson.fromJson(rulesString, Rules.class);

        assertNotNull(rules);
        assertNotNull(rules.getRules());

    }
}
